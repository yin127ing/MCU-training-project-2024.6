C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\OBJ\Objects\main.obj
COMPILER INVOKED BY: D:\Program Files\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\USER;..\OBJ) DEB
                    -UG OBJECTEXTEND PRINT(.\Listings\main.lst) OBJECT(..\OBJ\Objects\main.obj)

line level    source

   1          #include<reg51.h>
   2          
   3          #include "uart.h"
   4          #include "temperature.h"
   5          
   6          #define uchar unsigned char
   7          #define uint unsigned int
   8          #define DataPort P0   //æ•°ç ç®¡æ®µé€‰ å¼•è„š
   9          
  10          //**********************************************************************
  11          //å¼•è„šè®¾ç½®    ç…§ç€ä»¿çœŸå›¾æ¥
  12          // 
  13          sbit CHANGE1 = P2 ^ 5;
  14          sbit CHANGE2 = P2 ^ 6;
  15          //NO.1
  16          sbit R = P1 ^ 0;        //æ•°æ®ä¸²å£è¾“å…¥
  17          sbit CLK = P1 ^ 1;      //è„‰å†²ä¿¡å·è¾“å…¥
  18          sbit STB = P1 ^ 2;      //é”å­˜ä¿¡å·
  19          
  20          sbit key_u = P1 ^ 3;     //æŒ‰é”®å¼•è„š
  21          sbit key_d = P1 ^ 4;
  22          sbit key_r = P1 ^ 5;
  23          sbit key_l = P1 ^ 6;
  24          sbit key_m = P1 ^ 7;
  25          sbit key_change = P2 ^ 7;
  26          
  27          //NO.2
  28          sbit seg1 = P2 ^ 0;       //æ•°ç ç®¡
  29          sbit seg2 = P2 ^ 1;
  30          sbit seg3 = P2 ^ 2;
  31          sbit buzzer = P3 ^ 7;     //èœ‚é¸£å™¨å¼•è„š
  32          
  33          sbit key_mode = P3 ^ 2;   //5ä¸ªæŒ‰é”®
  34          sbit key_2 = P3 ^ 3;
  35          sbit key_3 = P3 ^ 4;
  36          sbit key_jia = P3 ^ 5;
  37          sbit key_jian = P3 ^ 6;
  38          
  39          //**********************************************************************
  40          //NO.1
  41          uchar order = 0;       //å¾—åˆ°çš„å‘½ä»¤
  42          uint move = 0;           //å½“å‰åˆ°ç¬¬å‡ ä¸ªæ•°æ®
  43          uint hanzi_num = 3;  //æ±‰å­—çš„ä¸ªæ•°
  44          uint hanzi_table_num = 1;   //æ˜¾ç¤ºç¬¬å‡ ç»„æ–‡å­—
  45          
  46          uchar code table1[][32 * 10] = {   //é˜´ç   é€è¡Œ  é€†å‘
  47          {0x10,0x01,0x10,0x01,0x10,0x01,0x88,0x7F,
  48          0x88,0x40,0x4C,0x20,0x2C,0x04,0x0A,0x04,
  49          0x89,0x14,0x88,0x24,0x48,0x24,0x48,0x44,
  50          0x28,0x44,0x08,0x04,0x08,0x05,0x08,0x02,/*"ä½ ",0*/
  51          0x08,0x00,0x08,0x3F,0x08,0x20,0x08,0x10,
  52          0x3F,0x08,0x24,0x04,0x24,0x04,0xA4,0x7F,
  53          0x24,0x04,0x12,0x04,0x14,0x04,0x08,0x04,
  54          0x14,0x04,0x22,0x04,0x21,0x05,0x00,0x02,/*"å¥½",1*/
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 2   

  55          0x00,0x00,0xC0,0x3F,0x1E,0x08,0x92,0x08,
  56          0x92,0x08,0x92,0x08,0x52,0x08,0xD2,0x7F,
  57          0x12,0x0C,0x12,0x0A,0x1E,0x09,0x92,0x08,
  58          0x40,0x08,0x20,0x08,0x00,0x0A,0x00,0x04,/*"å‘€",2*/
  59          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, //å°¾éƒ¨çš„ä¸€å±çš„ç©ºå­
             -—ç¬¦ï¼Œç”¨äºæ¸…å±ï¼Œå‚æ•°å’Œå±å¤§å°æœ‰å…³ã€‚
  60          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
  61          },
  62          {0x00,0x00,0x08,0x1C,0x0E,0x22,0x08,0x20,
  63          0x08,0x10,0x08,0x08,0x08,0x04,0x3E,0x3E,
  64          0x00,0x00,0x1C,0x18,0x22,0x14,0x20,0x14,
  65          0x18,0x12,0x20,0x3E,0x22,0x10,0x1C,0x10,/*"1234",0*/
  66          0x00,0x00,0x3E,0x1C,0x02,0x02,0x02,0x02,
  67          0x1C,0x1E,0x20,0x22,0x20,0x22,0x1E,0x1C,
  68          0x00,0x00,0x3E,0x1C,0x20,0x22,0x10,0x22,
  69          0x10,0x3E,0x08,0x22,0x04,0x22,0x04,0x1C,/*"5678",0*/
  70              0x00,0x00,0x1C,0x1C,0x22,0x22,0x22,0x22,
  71          0x3C,0x22,0x20,0x22,0x20,0x22,0x1C,0x1C,
  72          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  73          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"90  ",0*/
  74          0x00,0x00,0x22,0x1C,0x22,0x08,0x22,0x08,
  75          0x3E,0x08,0x22,0x08,0x22,0x08,0x22,0x1C,
  76          0x00,0x00,0x3C,0x22,0x10,0x12,0x10,0x0A,
  77          0x10,0x06,0x10,0x0A,0x12,0x12,0x0C,0x22,/*"hijlk",0*/
  78          
  79          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, //å°¾éƒ¨çš„ä¸€å±çš„ç©ºå­
             -—ç¬¦ï¼Œç”¨äºæ¸…å±ï¼Œå‚æ•°å’Œå±å¤§å°æœ‰å…³ã€‚
  80          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  81          }
  82          
  83          };
  84          
  85          //NO.2
  86          uchar code dofly_table[10] = { 0xc0, 0xf9, 0xa4, 0xb0, 0x99, 0x92, 0x82, 0xf8, 0x80, 0x90, }; //æ®µé€‰ ç 
  87          uchar hour = 12, min = 12, sec = 0; //æ—¶é—´  æ—¶åˆ†ç§’
  88          uchar buzzer_flag = 0;             //èœ‚é¸£å™¨çŠ¶æ€
  89          uchar seg_show[8] = { 0xc0, 0xf9, 0xa4, 0xb0, 0x99, 0x92, 0x82, 0xf8 };    //ç”¨äºç¼“å­˜å³å°†æ˜¾ç¤ºçš„ æ
             -•°ç ç®¡å€¼
  90          uchar seg_num = 0;        //ç”¨äºåœ¨å…¨å±€ä¸­  å®šæ—¶å™¨ä¸­åˆ·æ–°
  91          uchar setting_flag = 0;   //éè®¾ç½® æš‚åœ       è®¾ç½® ç»§ç»­
  92          uchar sec_temp = 0;             //ç”¨äºå®šæ—¶å™¨è®¡ç®— æ—¶é—´çš„
  93          uchar naozhong_hour = 12, naozhong_min = 0, naozhong_flag = 0;    //å…³äºé—¹é’Ÿçš„
  94          
  95          uchar jishi_min = 0, jishi_sec = 0, jishi_5ms = 0;       //å…³äºè®¡æ—¶åŠŸèƒ½çš„
  96          uchar jishi_flag = 0;     //æ˜¯å¦å¼€å§‹è®¡æ—¶
  97          
  98          uchar show_temp[32];    //ç”¨äºæ˜¾ç¤ºçš„ç¼“å­˜
  99          
 100          uchar zuoyou_temp[16];   //ç”¨äºå·¦å³ç§»åŠ¨çš„æ˜¾ç¤ºä¹‹å¤–çš„ç¼“å­˜
 101          char code Hang[] = { 0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f };  //ç”¨äºè¡Œç   ï¼Œé€‰æ‹©è¡Œç”¨çš„ 595
 102          //**********************************************************************
 103          //åŠŸèƒ½å‡½æ•°
 104          //NO.1
 105          
 106          void delay(int z)                               //å»¶æ—¶ç¨‹åº
 107          {
 108   1          int x, y;
 109   1          for (x = 55; x > 0; x--)
 110   1              for (y = z; y > 0; y--);
 111   1      }
 112          
 113          void wordByt(char b)                    //å†™ï¼ˆæ‹†åˆ†ï¼‰ä¸€ä¸ªå­—èŠ‚æ•°æ®  ä¼ ç»™595èŠ¯ç‰‡
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 3   

 114          {
 115   1          char i;
 116   1          for (i = 0; i < 8; i++)
 117   1          {
 118   2              b = b >> 1;                     //å³ç§»ä¸€ä½ï¼Œæš‚å­˜è¿‘CY
 119   2              R = CY;                         //å–å‡ºæœ€ä½ä½
 120   2              CLK = 0;                        //ä¸Šå‡æ²¿     
 121   2              CLK = 1;
 122   2          }
 123   1      }
 124          
 125          //NO.2
 126          void seg_switch(uchar num) {             //è®©138è¯‘ç å™¨é€‰ä¸­ä½é€‰
 127   1          seg3 = num / 4 % 2;
 128   1          seg2 = num / 2 % 2;
 129   1          seg1 = num % 2;
 130   1      }
 131          delay_ms(uint x)    //mså»¶æ—¶å‡½æ•°
 132          {
 133   1          uint i, j;
 134   1          for (j = 0; j < x; j++)
 135   1              for (i = 0; i < 123; i++);
 136   1      }
 137          void Init_Timer0(void)  //å®šæ—¶å™¨0  åˆå§‹åŒ–   ç”¨äºæä¾›æ—¶é—´ 10msä¸­æ–­ä¸€æ¬¡
 138          {
 139   1          TMOD |= 0x01;    //ä½¿ç”¨æ¨¡å¼1ï¼Œ16ä½å®šæ—¶å™¨ï¼Œä½¿ç”¨"|"ç¬¦å·å¯ä»¥åœ¨ä½¿ç”¨å¤šä¸ªå®šæ—¶å™¨æ—¶ä¸
             -å—å½±å“
 140   1          TH0 = (65536 - 9216) / 256;  //ç»™å®šåˆå€¼ï¼Œ
 141   1          TL0 = (65536 - 9216) % 256;
 142   1          EA = 1;          //æ€»ä¸­æ–­æ‰“å¼€
 143   1          ET0 = 1;         //å®šæ—¶å™¨ä¸­æ–­æ‰“å¼€
 144   1          TR0 = 1;         //å®šæ—¶å™¨å¼€å…³æ‰“å¼€
 145   1      }
 146          
 147          
 148          //**********************************************************************
 149          //ä¸»å‡½æ•°
 150          //NO.1
 151          int i = 0;
 152          
 153          void NO_1_main()
 154          {
 155   1      
 156   1          int num, speed;     //numç”¨äºæ˜¾ç¤º   speedç”¨äºæ˜¾ç¤ºçš„é€Ÿåº¦çš„
 157   1          uint temp;              //ç¼“å­˜ ä¸€å­—èŠ‚æ•°æ®  
 158   1          uchar hanzi_witch = 1;  //æ˜¾ç¤ºæ±‰å­—é‚£ç»„æ•°æ®   è¿˜æ˜¯æ˜¾ç¤ºASCIIé‚£ç»„æ•°æ®
 159   1      
 160   1          hanzi_num = 3;        //å½“å‰ç»„æ•°æ® æ±‰å­—çš„ä¸ªæ•°
 161   1      
 162   1      
 163   1          key_u = 1;       //æŒ‰é”®é«˜ç”µå¹³
 164   1          key_d = 1;
 165   1          key_r = 1;
 166   1          key_l = 1;
 167   1          key_m = 1;
 168   1          key_change = 1;
 169   1          order = 'm';    //å¼€æœºé»˜è®¤é€å­—åˆ‡æ¢åŠŸèƒ½
 170   1          move = 0;      //ç§»åŠ¨å˜é‡ä¸º0  ä»å¤´å¼€å§‹
 171   1      
 172   1          while (!CHANGE1)
 173   1          {
 174   2      
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 4   

 175   2      
 176   2              if (key_u == 0) {    //å‘ä¸Šç§»åŠ¨çš„æŒ‰é”®   è®©æ¨¡å¼ä¸º â€˜uâ€™  ï¼Œä»å¤´å¼€å§‹
 177   3                  order = 'u';
 178   3                  move = 0;
 179   3              }
 180   2              if (key_d == 0) {   //å‘ä¸‹ç§»åŠ¨çš„æŒ‰é”®æŒ‰ä¸‹  ä»å¤´å¼€å§‹
 181   3                  order = 'd';
 182   3                  move = 0;
 183   3                  for (i = 0; i < 16; i++) {   //åˆå§‹åŒ–è¦æ˜¾ç¤ºçš„ç¼“å­˜æ•°ç»„ï¼ˆå¤åˆ¶è¿‡æ¥ï¼‰
 184   4                      show_temp[i * 2] = table1[hanzi_table_num - 1][i * 2];
 185   4                      show_temp[i * 2 + 1] = table1[hanzi_table_num - 1][i * 2 + 1];
 186   4                  }
 187   3              }
 188   2              if (key_r == 0) {   //å‘å³ç§»åŠ¨çš„æŒ‰é”®æŒ‰ä¸‹  ä»å¤´å¼€å§‹
 189   3                  order = 'r';
 190   3                  move = 0;
 191   3                  for (i = 0; i < 16; i++) {    //åˆå§‹åŒ–è¦æ˜¾ç¤ºçš„ç¼“å­˜æ•°ç»„ï¼ˆå¤åˆ¶è¿‡æ¥ï¼‰ 
 192   4                      show_temp[i * 2] = table1[hanzi_table_num - 1][i * 2];
 193   4                      show_temp[i * 2 + 1] = table1[hanzi_table_num - 1][i * 2 + 1];
 194   4                      zuoyou_temp[i] = table1[hanzi_table_num - 1][i * 2 + 32 + 1];   //ä»¥åŠå…³ç³»åˆ°ä¸‹ä¸€ä¸ª
             -æ±‰å­—çš„åä¸€åŠå†…å®¹ï¼Œä¹Ÿç¼“å­˜è¿‡æ¥   ç”¨äºè¡”æ¥ä¸Šä¸€ä¸ªæ–‡å­—
 195   4                  }
 196   3              }
 197   2              if (key_l == 0) { //å‘å·¦ç§»åŠ¨çš„æŒ‰é”®æŒ‰ä¸‹  ä»å¤´å¼€å§‹
 198   3                  order = 'l';
 199   3                  move = 0;
 200   3                  for (i = 0; i < 16; i++) {   //åˆå§‹åŒ–è¦æ˜¾ç¤ºçš„ç¼“å­˜æ•°ç»„ï¼ˆå¤åˆ¶è¿‡æ¥ï¼‰
 201   4                      show_temp[i * 2] = table1[hanzi_table_num - 1][i * 2];
 202   4                      show_temp[i * 2 + 1] = table1[hanzi_table_num - 1][i * 2 + 1];
 203   4                      zuoyou_temp[i] = table1[hanzi_table_num - 1][i * 2 + 32];    //ä»¥åŠå…³ç³»åˆ°ä¸‹ä¸€ä¸ªæ±‰
             -å­—çš„å‰ä¸€åŠå†…å®¹ï¼Œä¹Ÿç¼“å­˜è¿‡æ¥   ç”¨äºè¡”æ¥ä¸Šä¸€ä¸ªæ–‡å­—
 204   4                  }
 205   3              }
 206   2              if (key_m == 0) {  //é€ä¸ªå­—åˆ‡æ¢çš„æŒ‰é”®æŒ‰ä¸‹  ä»å¤´å¼€å§‹
 207   3                  order = 'm';
 208   3                  move = 0;
 209   3              }
 210   2              if (key_change == 0) {   //æ˜¾ç¤ºå†…å®¹æ•°ç»„å˜åŒ–  æŒ‰é”®æŒ‰ä¸‹   åˆ‡æ¢å†…å®¹åºå·
 211   3                  move = 0;
 212   3                  hanzi_witch++;
 213   3                  if (hanzi_witch >= 3) hanzi_witch = 1;
 214   3      
 215   3                  if (hanzi_witch == 1) {   //1  æ˜¯æ±‰å­—æ•°ç»„   æ±‰å­—3ä¸ª   ç´¢å¼•ä¸º1
 216   4                      hanzi_num = 3;
 217   4                      hanzi_table_num = 1;
 218   4                  }
 219   3                  if (hanzi_witch == 2) { //2  æ˜¯å­—ç¬¦æ•°ç»„  é¡µé¢4ä¸ª   ç´¢å¼•ä¸º2
 220   4                      hanzi_num = 4;
 221   4                      hanzi_table_num = 2;
 222   4                  }
 223   3                  order = 'm';                 //é»˜è®¤ä¸º é€é¡µå˜åŒ–çš„   
 224   3                  while (key_change == 0);    //ç­‰å¾…æŒ‰é”®æ¾å¼€
 225   3      
 226   3              }
 227   2      
 228   2              for (num = 0; num < 16; num++) //æ˜¾ç¤ºå¤„ç†  16*16å›¾åƒ    é€è¡Œæ˜¾ç¤º  ï¼Œå…±æ˜¾ç¤º16è¡Œ
 229   2              {
 230   3                  if (num < 8) {          //å‰8è¡Œ
 231   4                      wordByt(Hang[num]);
 232   4                      wordByt(0xff);
 233   4                  }
 234   3                  else {         //å8è¡Œ
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 5   

 235   4                      wordByt(0xff);
 236   4                      wordByt(Hang[num - 8]);
 237   4                  }
 238   3                  if ((order == 'u') || (order == 'm')) {    //å‘ä¸Šç§»åŠ¨  å’Œ é€å­—å˜åŒ–   æ—¶ï¼Œç›´æ¥è®¡ç
             -®—ä»åŸå§‹æ•°æ®è·å–æ˜¾ç¤º
 239   4                      wordByt(table1[hanzi_table_num - 1][2 * num + move * 2]);
 240   4                      wordByt(table1[hanzi_table_num - 1][2 * num + 1 + move * 2]);
 241   4                  }
 242   3                  if ((order == 'd') || (order == 'l') || (order == 'r')) {  //å‘ä¸‹ å‘å·¦ å³ æ¨¡å¼ï¼Œæ˜¾ç¤º
             -å¤„ç†åçš„ç¼“å­˜æ•°ç»„å†…å®¹
 243   4                      wordByt(show_temp[2 * num]);
 244   4                      wordByt(show_temp[2 * num + 1]);
 245   4                  }
 246   3                  STB = 1;  //è¾“å‡ºé”å­˜ä¸­çš„æ•°æ®ï¼Œä¸‹é™æ²¿    æ˜¾ç¤ºä¸€è¡Œ
 247   3                  STB = 0;
 248   3                  delay(2);   //  å»¶æ—¶ä¸€ä¸‹
 249   3              }
 250   2      
 251   2      
 252   2              if (order == 'l') {      //å‘å·¦ç§»åŠ¨
 253   3                  if (++speed > 6) //é€Ÿåº¦æ§åˆ¶ï¼ˆæ•°å­—å°é€Ÿåº¦å¿«ï¼‰
 254   3                  {
 255   4                      speed = 0;
 256   4                      move++;   //ç§»ä½  ç§»åŠ¨1åˆ—
 257   4      
 258   4                      for (i = 0; i < 16; i++) {   //æ•°æ®å¤„ç†
 259   5                          if (show_temp[i * 2 + 1] & 0x01 == 0x01)  show_temp[i * 2] = ((show_temp[i * 2]) >> 1)
             - | 0x80; //å…ˆå‘å·¦ç§»åŠ¨ä¸€åˆ—    æ•°ç»„å†…å®¹
 260   5                          else show_temp[i * 2] = ((show_temp[i * 2]) >> 1) & 0x7f;
 261   5                          if (zuoyou_temp[i] & 0x01 == 0x01)  show_temp[i * 2 + 1] = ((show_temp[i * 2 + 1]) >> 
             -1) | 0x80;  //åˆ¤æ–­ä¸‹ä¸€å›¾åƒçš„ä¸€åˆ—ï¼Œæ ¹æ®0æˆ–1æ’å…¥ä¸Šé¢ç§»åŠ¨1åˆ—åçš„æ•°ç»„é‡Œ
 262   5                          else show_temp[i * 2 + 1] = ((show_temp[i * 2 + 1]) >> 1) & 0x7f;
 263   5                          zuoyou_temp[i] = zuoyou_temp[i] >> 1;    //ä¸‹ä¸€å›¾åƒè·Ÿç€ç§»åŠ¨1åˆ—
 264   5                      }
 265   4                      if (move % 8 == 0) {   //ç§»åŠ¨å½“å‰å›¾åƒçš„8æ­¥ä¹‹å†…   æ›´æ–°ä¸‹ä¸€ä¸ªå›¾åƒçš„å‰ä¸€å
             -Šå†…å®¹åˆ°ç¼“å­˜æ•°ç»„é‡Œ 
 266   5                          if (move / 8 % 2 == 0) //ä¸Šä¸€è¾¹
 267   5                              for (i = 0; i < 16; i++) {
 268   6                                  zuoyou_temp[i] = table1[hanzi_table_num - 1][(move / 16 + 1) * 32 + i * 2];
 269   6                              }
 270   5      
 271   5                          if (move / 8 % 2 == 1) //ä¸‹ä¸€è¾¹   //ç§»åŠ¨å½“å‰å›¾åƒçš„8-15æ­¥   æ›´æ–°ä¸‹ä¸€ä¸ªå
             -›¾åƒçš„åä¸€åŠå†…å®¹åˆ°ç¼“å­˜æ•°ç»„é‡Œ 
 272   5                              for (i = 0; i < 16; i++) {
 273   6                                  zuoyou_temp[i] = table1[hanzi_table_num - 1][(move / 16 + 1) * 32 + i * 2 + 1]
             -;
 274   6                              }
 275   5      
 276   5                      }
 277   4      
 278   4                      if (move > 16 * hanzi_num) { //åˆ¤æ–­æ˜¯å¦å®Œæˆä¸€ä¸ªæ•°ç»„æ•°æ®
 279   5                          move = 0;                        //ä»å¤´å¼€å§‹
 280   5                          for (i = 0; i < 16; i++) {    //å¤åˆ¶æ•°æ®åˆ°ç¼“å­˜æ•°ç»„ä¸­
 281   6                              show_temp[i * 2] = table1[hanzi_table_num - 1][i * 2];
 282   6                              show_temp[i * 2 + 1] = table1[hanzi_table_num - 1][i * 2 + 1];
 283   6                              zuoyou_temp[i] = table1[hanzi_table_num - 1][i * 2 + 32];    //ä»¥åŠå…³ç³»åˆ°ä¸‹ä
             -¸€ä¸ªæ±‰å­—çš„å‰ä¸€åŠå†…å®¹ï¼Œä¹Ÿç¼“å­˜è¿‡æ¥   ç”¨äºè¡”æ¥ä¸Šä¸€ä¸ªæ–‡å­—
 284   6                          }
 285   5                      }
 286   4                  }
 287   3              }
 288   2              if (order == 'r') {      //å‘å³ç§»åŠ¨
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 6   

 289   3                  if (++speed > 6) //é€Ÿåº¦æ§åˆ¶ï¼ˆæ•°å­—å°é€Ÿåº¦å¿«ï¼‰
 290   3                  {
 291   4                      speed = 0;
 292   4                      move++;   //ç§»ä½
 293   4      
 294   4                      for (i = 0; i < 16; i++) { //å…ˆå‘å³ç§»åŠ¨ä¸€ä¸ª   æ˜¾ç¤ºæ•°æ®çš„å¤„ç†
 295   5      
 296   5                          temp = show_temp[i * 2] >> 7; //   ç§»åŠ¨æ ¹æ®åä¸€åŠå›¾åƒçš„1åˆ—æ•°æ®ï¼Œè½¬æ¢æ·
             -»åŠ åˆ°å³ç§»1åˆ—åçš„å‰ä¸€åŠå›¾åƒ
 297   5                          if (temp & 0x01 == 0x01)  show_temp[i * 2 + 1] = ((show_temp[i * 2 + 1]) << 1) | 0x01;
 298   5                          else show_temp[i * 2 + 1] = ((show_temp[i * 2 + 1]) << 1) & 0xfe;
 299   5      
 300   5                          temp = zuoyou_temp[i] >> 7;   //æ ¹æ®ä¸‹1ä¸ªå›¾åƒçš„å‰åŠéƒ¨åˆ†çš„1åˆ—æ•°æ®ï¼Œåˆ¤æ
             -–­æ·»åŠ åˆ°ä¸Š1ä¸ªå›¾åƒçš„1åˆ—ä¸­
 301   5                          if (temp & 0x01 == 0x01)  show_temp[i * 2] = ((show_temp[i * 2]) << 1) | 0x01;
 302   5                          else show_temp[i * 2] = ((show_temp[i * 2]) << 1) & 0xfe;
 303   5                          zuoyou_temp[i] = zuoyou_temp[i] << 1;  //ç¼“å­˜ä¹Ÿç§»åŠ¨1åˆ—
 304   5      
 305   5                      }
 306   4      
 307   4                      if (move % 8 == 0) {
 308   5                          if (move / 8 % 2 == 0) //ä¸Šä¸€è¾¹//ç§»åŠ¨å½“å‰å›¾åƒçš„8æ­¥ä¹‹å†…   æ›´æ–°ä¸‹ä¸€ä¸ªå
             -›¾åƒçš„ä¸Šä¸€åŠå†…å®¹åˆ°ç¼“å­˜æ•°ç»„é‡Œ 
 309   5                              for (i = 0; i < 16; i++) {
 310   6                                  zuoyou_temp[i] = table1[hanzi_table_num - 1][(move / 16 + 1) * 32 + i * 2 + 1]
             -;
 311   6                              }
 312   5                          if (move / 8 % 2 == 1) //ä¸‹ä¸€è¾¹//ç§»åŠ¨å½“å‰å›¾åƒçš„8æ­¥ä¹‹å†…   æ›´æ–°ä¸‹ä¸€ä¸ªå
             -›¾åƒçš„ä¸‹ä¸€åŠå†…å®¹åˆ°ç¼“å­˜æ•°ç»„é‡Œ 
 313   5                              for (i = 0; i < 16; i++) {
 314   6                                  zuoyou_temp[i] = table1[hanzi_table_num - 1][(move / 16 + 1) * 32 + i * 2];
 315   6                              }
 316   5                      }
 317   4      
 318   4                      if (move > 16 * hanzi_num) { //åˆ¤æ–­æ˜¯å¦å®Œæˆä¸€ä¸ªæ±‰å­—
 319   5                          move = 0;          //ä»å¤´å¼€å§‹
 320   5                          for (i = 0; i < 16; i++) {  //å¤åˆ¶æ•°æ®  ä»æ–°å¼€å§‹
 321   6                              show_temp[i * 2] = table1[hanzi_table_num - 1][i * 2];
 322   6                              show_temp[i * 2 + 1] = table1[hanzi_table_num - 1][i * 2 + 1];
 323   6                              zuoyou_temp[i] = table1[hanzi_table_num - 1][i * 2 + 32 + 1];   //ä»¥åŠå…³ç³»åˆ°ä
             -¸‹ä¸€ä¸ªæ±‰å­—çš„åä¸€åŠå†…å®¹ï¼Œä¹Ÿç¼“å­˜è¿‡æ¥   ç”¨äºè¡”æ¥ä¸Šä¸€ä¸ªæ–‡å­—
 324   6                          }
 325   5                      }
 326   4                  }
 327   3              }
 328   2      
 329   2              if (order == 'd') {      //å‘ä¸‹ç§»åŠ¨
 330   3                  if (++speed > 5) //é€Ÿåº¦æ§åˆ¶ï¼ˆæ•°å­—å°é€Ÿåº¦å¿«ï¼‰
 331   3                  {
 332   4                      speed = 0;
 333   4                      move++;   //ç§»ä½
 334   4      
 335   4                      for (i = 14; i >= 0; i--) {       //ç¼“å­˜æ•°æ®å…ˆå‘ä¸‹ç§»åŠ¨ä¸€ä¸ª
 336   5                          show_temp[(i + 1) * 2] = show_temp[i * 2];
 337   5                          show_temp[(i + 1) * 2 + 1] = show_temp[i * 2 + 1];
 338   5                      }
 339   4                      //ç¬¬ä¸€è¡Œæ•°æ®ç”±ä¸‹ä¸€ä¸ªå›¾åƒçš„æœ€åä¸€è¡Œæ•°æ®å¡«å……
 340   4                      show_temp[0] = table1[hanzi_table_num - 1][(move / 16 + 2) * 32 - (move * 2) % 32];
 341   4                      show_temp[1] = table1[hanzi_table_num - 1][(move / 16 + 2) * 32 + 1 - (move * 2) % 32];
 342   4      
 343   4                      if (move > 16 * hanzi_num) { //åˆ¤æ–­æ˜¯å¦å®Œæˆä¸€ä¸ªæ±‰å­—
 344   5                          move = 0;            //ä»å¤´å¼€å§‹
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 7   

 345   5                          for (i = 0; i < 16; i++) {   //å¤åˆ¶æ•°æ®ï¼Œé‡æ–°å¼€å§‹
 346   6                              show_temp[i * 2] = table1[hanzi_table_num - 1][i * 2];
 347   6                              show_temp[i * 2 + 1] = table1[hanzi_table_num - 1][i * 2 + 1];
 348   6                          }
 349   5      
 350   5                      }
 351   4                  }
 352   3              }
 353   2      
 354   2              if (order == 'u') {      //å‘ä¸Šç§»åŠ¨    å®ƒçš„æ•°ç»„æ•°æ®é¡ºåºç¬¦åˆå‘ä¸Šçš„ï¼Œæ‰€ä»¥æ•°æ®ä
             -¸å¿…å¤„ç†
 355   3                  if (++speed > 5) //é€Ÿåº¦æ§åˆ¶ï¼ˆæ•°å­—å°é€Ÿåº¦å¿«ï¼‰
 356   3                  {
 357   4                      speed = 0;
 358   4                      move++;   //ç§»ä½
 359   4                      if (move > 16 * hanzi_num) //åˆ¤æ–­æ˜¯å¦å®Œæˆä¸€ä¸ªæ±‰å­—
 360   4                          move = 0; //ä»å¤´å¼€å§‹
 361   4                  }
 362   3              }
 363   2              if (order == 'm') {        //é€ä¸ªå­—æ˜¾ç¤º
 364   3                  if (++speed > 25) //é€Ÿåº¦æ§åˆ¶ï¼ˆæ•°å­—å°é€Ÿåº¦å¿«ï¼‰
 365   3                  {
 366   4                      speed = 0;
 367   4                      move += 16; //ç§»ä½   ä¸‹ä¸€ä¸ªå›¾åƒ
 368   4                      if (move > 16 * hanzi_num) //åˆ¤æ–­æ˜¯å¦å®Œæˆä¸€ä¸ªæ±‰å­—
 369   4                          move = 0; //ä»å¤´å¼€å§‹
 370   4                  }
 371   3              }
 372   2          }
 373   1      }
 374          
 375          void NO_2_main()
 376          {
 377   1          //uint i;
 378   1          uint temp;                  //æ¸©åº¦
 379   1          uchar mode_num = 0;         //æ¨¡å¼çš„å€¼
 380   1          uint run_times = 0;     //ä¸»å¾ªç¯ä¸­è¿è¡Œå¤šå°‘æ¬¡
 381   1          uchar wei_num = 0;     //æ—¶åˆ†ç§’ä½æ•°çš„
 382   1          DataPort = 0xff;       //ä¸æ˜¾ç¤º
 383   1          buzzer = 1;    //èœ‚é¸£å™¨ä¸å“
 384   1      
 385   1          //uart_init();
 386   1          Init_Timer0(); //å®šæ—¶å™¨0  ä¸­æ–­ ç”¨äºæ•°ç ç®¡æ˜¾ç¤º
 387   1          Init_DS18B20();              //åˆå§‹åŒ–ds18b20
 388   1          ReadTemperature();   //è¯»å–æ¸©åº¦ï¼Œ
 389   1          delay_ms(20);
 390   1      
 391   1          while (!CHANGE2)        //å¤§å¾ªç¯
 392   1          {
 393   2              if (key_mode == 0) {    //æ¨¡å¼åˆ‡æ¢  æŒ‰é’®
 394   3                  delay_ms(10);
 395   3                  if (key_mode == 0) {
 396   4                      mode_num++;
 397   4                      if (mode_num >= 3) mode_num = 0;        //å¯¹åº”3ç§æ¨¡å¼
 398   4      
 399   4                      setting_flag = 0;  //åˆ‡æ¢æ¨¡å¼çš„æ—¶å€™å…³é—­è®¾ç½®
 400   4                      while (key_mode == 0);
 401   4                      delay_ms(10);
 402   4                  }
 403   3              }
 404   2              if (key_2 == 0) {                //è®¾ç½®       æŒ‰é’®
 405   3                  delay_ms(10);
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 8   

 406   3                  if (key_2 == 0) {
 407   4                      setting_flag = 1 - setting_flag;        //å–å
 408   4                      if (mode_num == 2) {            //è®¡æ—¶æ¨¡å¼ä¸‹  å¼€å§‹  æš‚åœ
 409   5                          jishi_flag = 1 - jishi_flag;
 410   5                      }
 411   4                      while (key_2 == 0);
 412   4                      //delay_ms(10);
 413   4                  }
 414   3              }
 415   2              if (key_3 == 0) {                //æ—¶åˆ†ç§’  ä½æ•°é€‰æ‹©       å¤ä½è®¡æ—¶
 416   3                  delay_ms(10);
 417   3                  if (key_3 == 0) {
 418   4                      if (mode_num == 0) {     //ä¼šé—ªçƒ
 419   5                          wei_num++;                   //å³å°†è®¾ç½®çš„é‚£ä¸¤ä½æ•°  ä¼šé—ªçƒ
 420   5                          if (wei_num >= 3) wei_num = 0;
 421   5                      }
 422   4                      if (mode_num == 1) {
 423   5                          wei_num++;
 424   5                          if (wei_num >= 3) wei_num = 0;
 425   5                      }
 426   4                      if (mode_num == 2) {     //å¤ä½è®¡æ—¶
 427   5                          jishi_min = 0;
 428   5                          jishi_sec = 0;
 429   5                          jishi_5ms = 0;
 430   5                          jishi_flag = 0;
 431   5                      }
 432   4      
 433   4                      while (key_3 == 0);
 434   4                      delay_ms(10);
 435   4                  }
 436   3              }
 437   2              if (key_jian == 0) {             //--  æ—¶é’Ÿã€é—¹é’Ÿçš„å‡
 438   3                  delay_ms(10);
 439   3                  if (key_jian == 0) {
 440   4                      if (mode_num == 0) {
 441   5                          if (wei_num == 0) {
 442   6                              if (hour == 0) hour = 23;
 443   6                              else hour--;
 444   6                          }
 445   5                          if (wei_num == 1) {
 446   6                              if (min == 0) min = 59;
 447   6                              else min--;
 448   6                          }
 449   5                          if (wei_num == 2) {
 450   6                              if (sec == 0) sec = 59;
 451   6                              else sec--;
 452   6                          }
 453   5                      }
 454   4                      if (mode_num == 1) {
 455   5                          if (wei_num == 0) {
 456   6                              if (naozhong_hour <= 0) naozhong_hour = 23;
 457   6                              else naozhong_hour--;
 458   6                          }
 459   5                          if (wei_num == 1) {
 460   6                              if (naozhong_min <= 0) naozhong_min = 59;
 461   6                              else naozhong_min--;
 462   6                          }
 463   5                          if (wei_num == 2) {
 464   6                              if (naozhong_flag <= 0) naozhong_flag = 1;
 465   6                              else  naozhong_flag--;
 466   6                          }
 467   5                      }
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 9   

 468   4                      while (key_jian == 0);
 469   4                      delay_ms(10);
 470   4                  }
 471   3              }
 472   2              if (key_jia == 0) {              //++    æ—¶é’Ÿã€é—¹é’Ÿçš„  åŠ 
 473   3                  delay_ms(10);
 474   3                  if (key_jia == 0) {
 475   4                      if (mode_num == 0) {
 476   5                          if (wei_num == 0) {
 477   6                              hour++;
 478   6                              if (hour >= 24) hour = 0;
 479   6                          }
 480   5                          if (wei_num == 1) {
 481   6                              min++;
 482   6                              if (min >= 60) min = 0;
 483   6                          }
 484   5                          if (wei_num == 2) {
 485   6                              sec++;
 486   6                              if (sec >= 60) sec = 0;
 487   6                          }
 488   5                      }
 489   4                      if (mode_num == 1) {
 490   5                          if (wei_num == 0) {
 491   6                              naozhong_hour++;
 492   6                              if (naozhong_hour >= 24) naozhong_hour = 0;
 493   6                          }
 494   5                          if (wei_num == 1) {
 495   6                              naozhong_min++;
 496   6                              if (naozhong_min >= 60) naozhong_min = 0;
 497   6                          }
 498   5                          if (wei_num == 2) {
 499   6                              naozhong_flag++;
 500   6                              if (naozhong_flag >= 2) naozhong_flag = 0;
 501   6                          }
 502   5                      }
 503   4                      while (key_jia == 0);
 504   4                      delay_ms(10);
 505   4                  }
 506   3              }
 507   2              if (naozhong_flag == 1) {    //é—¹é’Ÿå¼€å¯       å“1åˆ†é’Ÿ
 508   3                  if ((naozhong_hour == hour) && (naozhong_min == min)) buzzer = 0;
 509   3                  else buzzer = 1;
 510   3              }
 511   2              else buzzer = 1;
 512   2      
 513   2              if (mode_num == 0) {    //æ˜¾ç¤ºæ—¶é—´æ¨¡å¼
 514   3                  seg_show[2] = 0xbf;   //â€œ-â€
 515   3                  seg_show[5] = 0xbf;   //â€œ-â€
 516   3                  seg_show[0] = dofly_table[hour / 10 % 10];
 517   3                  seg_show[1] = dofly_table[hour % 10];
 518   3                  seg_show[3] = dofly_table[min / 10 % 10];
 519   3                  seg_show[4] = dofly_table[min % 10];
 520   3                  seg_show[6] = dofly_table[sec / 10 % 10];
 521   3                  seg_show[7] = dofly_table[sec % 10];
 522   3                  if ((setting_flag == 1) && (sec_temp < 100)) {   //æ˜¯å¦ä¸ºè®¾ç½®æƒ…å†µ
 523   4                      seg_show[3 * wei_num] = 0xff;
 524   4                      seg_show[3 * wei_num + 1] = 0xff;
 525   4                  }
 526   3              }
 527   2      
 528   2              if (mode_num == 1) {                             //é—¹é’Ÿæ¨¡å¼
 529   3                  seg_show[2] = 0xbf;   //â€œ-â€
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 10  

 530   3                  seg_show[5] = 0xff;   //â€œ â€
 531   3                  seg_show[6] = 0xff; //â€˜ â€™
 532   3                  seg_show[0] = dofly_table[naozhong_hour / 10 % 10];
 533   3                  seg_show[1] = dofly_table[naozhong_hour % 10];
 534   3                  seg_show[3] = dofly_table[naozhong_min / 10 % 10];
 535   3                  seg_show[4] = dofly_table[naozhong_min % 10];
 536   3      
 537   3                  seg_show[7] = dofly_table[naozhong_flag % 10];
 538   3                  if ((setting_flag == 1) && (sec_temp < 100)) {        //æ˜¯å¦è®¾ç½®æƒ…å†µ
 539   4                      seg_show[3 * wei_num] = 0xff;
 540   4                      seg_show[3 * wei_num + 1] = 0xff;
 541   4                  }
 542   3              }
 543   2      
 544   2              if (mode_num == 2) {      //æ¸©åº¦+ç§’è¡¨  æ¨¡å¼
 545   3                  run_times++;
 546   3                  if (run_times >= 50) {       //æ¸©åº¦ä¸èƒ½å¤ªé«˜é¢‘çš„è·å–
 547   4                      run_times = 0;
 548   4                      temp = (uint)((float)ReadTemperature() * 0.0625); //æ¸©åº¦
 549   4                      if (temp >= 1) {                 //é˜²æ­¢å› ä¸ºä¸­æ–­å‡ºé”™
 550   5                          seg_show[0] = dofly_table[temp / 10 % 10];
 551   5                          seg_show[1] = dofly_table[temp / 1 % 10];
 552   5                      }
 553   4                  }              //åˆ·æ–°ç§’è¡¨è®¡æ—¶çš„æ•°å€¼
 554   3                  seg_show[2] = 0xff;   //â€œ â€
 555   3                  seg_show[3] = dofly_table[jishi_min / 10 % 10];
 556   3                  seg_show[4] = dofly_table[jishi_min % 10] & 0x7f;
 557   3                  seg_show[5] = dofly_table[jishi_sec / 10 % 10];
 558   3                  seg_show[6] = dofly_table[jishi_sec % 10] & 0x7f;
 559   3                  seg_show[7] = dofly_table[jishi_5ms % 10];
 560   3              }
 561   2      
 562   2              delay_ms(10);
 563   2          }
 564   1      
 565   1          DataPort = 0xff;
 566   1      
 567   1      }
 568          
 569          //å®šæ—¶å™¨0ä¸­æ–­æœåŠ¡å‡½æ•°   ç”¨äºæ•°ç ç®¡çš„æ˜¾ç¤º
 570          void Timer0_isr(void) interrupt 1 using 1
 571          {
 572   1          
 573   1          TH0 = (65536 - 4608) / 256;  //ç»™å®šåˆå€¼ï¼Œ 5ms
 574   1          TL0 = (65536 - 4608) % 256;
 575   1          seg_num++;       //æ•°ç ç®¡åˆ·æ–°
 576   1          if (seg_num >= 8)  seg_num = 0;
 577   1          DataPort = 0xff;       //è¿™é‡Œç”¨äºæ˜¾ç¤ºæ—¶é—´  æ—¶åˆ†ç§’
 578   1          seg_switch(seg_num);   //ä½é€‰ 
 579   1          DataPort = seg_show[seg_num];  //æ®µé€‰
 580   1      
 581   1          //æœ‰å…³è®¡æ—¶åŠŸèƒ½çš„
 582   1          if (jishi_flag == 1) {    //è®¡æ—¶  å¼€å§‹ ç»§ç»­
 583   2              jishi_5ms++;
 584   2              if (jishi_5ms >= 200) {
 585   3                  jishi_5ms = 0;
 586   3                  jishi_sec++;
 587   3              }
 588   2              if (jishi_sec >= 60) {
 589   3                  jishi_sec = 0;
 590   3                  jishi_min++;
 591   3              }
C51 COMPILER V9.60.7.0   MAIN                                                              06/21/2024 14:17:19 PAGE 11  

 592   2              if (jishi_min >= 60) {
 593   3                  jishi_min = 0;
 594   3              }
 595   2          }
 596   1          //æœ‰å…³æ—¶é’ŸåŠŸèƒ½çš„
 597   1          sec_temp++;
 598   1          if (sec_temp >= 200) {         //200æ¬¡å¾—1ç§’
 599   2              sec_temp = 0;
 600   2              sec++;
 601   2          }
 602   1          if (sec >= 60) {
 603   2              sec = 0;
 604   2              min++;
 605   2          }
 606   1          if (min >= 60) {
 607   2              min = 0;
 608   2              hour++;
 609   2          }
 610   1          if (hour >= 24) {
 611   2              hour = 0;
 612   2          }
 613   1      }
 614          
 615          void main() {
 616   1          while (1) { // æ— é™å¾ªç¯ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ¡ä»¶æ¥æ§åˆ¶å¾ªç¯
 617   2              if (!CHANGE1) {
 618   3                  NO_1_main();
 619   3              }
 620   2              if (!CHANGE2) {
 621   3                  NO_2_main();
 622   3              }
 623   2              else {
 624   3                  DataPort = 0xff;
 625   3              }
 626   2          }
 627   1      }
*** WARNING C290 IN LINE 136 OF main.c: missing return value


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3844    ----
   CONSTANT SIZE    =    658    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     79      12
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
